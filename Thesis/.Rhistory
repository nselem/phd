CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastId, CyanosHeatPlot$TOTAL))
CyanosHeatPlot <- read.table("chapter5/CyanosHeatPlot", header=TRUE, sep="\t")
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastId, CyanosHeatPlot$TOTAL))
CyanosHeatPlot.m <- melt(CyanosHeatPlot)
View(CyanosHeatPlot.m)
View(CyanosHeatPlot.m)
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform, rescale=rescale(value))
(p <- ggplot(CyanosHeatPlot.m, aes(variable, CyanosHeatPlot)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
#(p <- ggplot(nba.m, aes(variable, Name)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform, rescale=rescale(value))
(p <- ggplot(CyanosHeatPlot.m, aes(variable, CyanosHeatPlot$RastId)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastId, CyanosHeatPlot$TOTAL))
CyanosHeatPlot.m <- melt(CyanosHeatPlot)
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform, CyanosHeatPlot$rescale=rescale(value))
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform,rescale=rescale(value))
rescale
CyanosHeatPlot$rescale
CyanosHeatPlot.m.$rescale
CyanosHeatPlot.m$rescale
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
```
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "black",na.value = "orange") + theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "black",na.value = "orange") + theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
#+coord_equal()
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "black",na.value = "orange")
#+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "black",na.value = "orange"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") +scale_fill_gradient(low = "white", high = "black"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
RastId
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastId, CyanosHeatPlot$TOTAL))
CyanosHeatPlot.m <- melt(CyanosHeatPlot)
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform,rescale=rescale(value))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "black"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)))
CyanosHeatPlot.m <- melt(CyanosHeatPlot)
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform,rescale=scale(value))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)))
#(p <- ggplot(nba.m, aes(variable, Name)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 330, hjust = 1, vjust = 0.5)+axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5)))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)+axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5)))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)  ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 330, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5) ))
#(p <- ggplot(nba.m, aes(variable, Name)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 330, hjust = 0, vjust = 0.5)+axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5)))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 330, hjust = 0, vjust = 0.5) ,axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5) ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 0, vjust = 0.5) ,axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5) ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5) ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) ))
CyanosHP.s <- ddply(CyanosHeatPlot.m, .(variable), transform, rescale = scale(value))
View(CyanosHP.s)
last_plot() %+% CyanosHP.s
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+geom_text() + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+geom_text(aes(fill = CyanosHeatPlot.m$rescale)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+geom_text(aes(label=CyanosHeatPlot.m$rescale)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) ))
label = "CyanoPlot", type = "figure")
(heatplot <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+geom_text(aes(label=CyanosHeatPlot.m$rescale)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) ))
ggsave("chapter5/HeatPlot.pdf", plot = heatplot,
height = 3, width = 6)
label(path = "chapter5/HeatPlot.pdf", caption = "Cyanobacterial Heatplot",  label = "CyanoPlot", type = "figure")
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$RastId,fill=CyanosHeatPlot.m$rescale)) + geom_boxplot()+  scale_y_continuous(name = "Difference between old activity\nand new activity by step")+scale_x_discrete(name = "Mutation name")+theme_bw()  +
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 11),
legend.position = "bottom") +facet_grid(CyanosHeatPlot.m$rescale~.,scales="free")
library(ggplot2)
library(ggplot2)
library( reshape )
library(plyr )
library(RColorBrewer)
library(scales)
library(plyr)
#setwd("/home/nelly/GIT/phd/Thesis/tesis/chap5_files")
CyanosCentral <- read.table("chapter5/CyanosCentral", header=TRUE, sep="\t")
CyanosHeatPlot <- read.table("chapter5/CyanosHeatPlot", header=TRUE, sep="\t")
CyanosNp <- read.table("chapter5/CyanosNp", header=TRUE, sep="\t")
CyanosSMASH <- read.table("chapter5/CyanosSMASH", header=TRUE, sep="\t")
CyanosTaxa <- read.table("chapter5/CyanosTaxa", header=TRUE, sep="\t")
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastId, CyanosHeatPlot$TOTAL))
CyanosHeatPlot.m <- melt(CyanosHeatPlot)
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform,rescale=scale(value))  ## rescale escala toda la matriz, scale por columnas
heatplot <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+ geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
#+geom_text(aes(label=CyanosHeatPlot.m$rescale))
ggsave("chapter5/HeatPlot.pdf", plot = heatplot,height = 12, width = 6)
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$RastId,fill=CyanosHeatPlot.m$rescale)) + geom_boxplot()+  scale_y_continuous(name = "Difference between old activity\nand new activity by step")+scale_x_discrete(name = "Mutation name")+theme_bw()  +
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 11),
legend.position = "bottom") +facet_grid(CyanosHeatPlot.m$rescale~.,scales="free")
View(mydata110)
View(mydata110)
knitr::opts_chunk$set(echo = TRUE)
mydata110 <- read.table("deltas110.r", header=TRUE, sep=",")
View(mydata110)
View(mydata110)
View(CyanosHeatPlot)
View(CyanosHeatPlot)
View(CyanosHeatPlot.m)
View(CyanosHeatPlot.m)
summary(CyanosHeatPlot.m)
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$RastId,fill=CyanosHeatPlot.m$rescale)) + geom_boxplot()
View(CyanosHeatPlot.m)
View(CyanosHeatPlot.m)
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale)) + geom_boxplot()
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale)) + geom_boxplot()+theme_bw()+theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(angle = 90,size = 11), legend.position = "bottom") +facet_grid(CyanosHeatPlot.m$rescale~.,scales="free")
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale)) + geom_boxplot()+theme_bw()+theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(angle = 90,size = 11), legend.position = "bottom")
#+facet_grid(CyanosHeatPlot.m$rescale~.,scales="free")
#ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale,fill=CyanosHeatPlot.m$rescale)) + geom_boxplot()
#+ scale_y_continuous(name = "Difference between old activity\nand new activity by step")+scale_x_discrete(name = "Mutation name")+theme_bw()  +theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(size = 11), legend.position = "bottom") +facet_grid(CyanosHeatPlot.m$rescale~.,scales="free")
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale)) + geom_boxplot()+theme_bw()+theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(angle = 90,size = 6), legend.position = "bottom")
#+facet_grid(CyanosHeatPlot.m$rescale~.,scales="free")
#ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale,fill=CyanosHeatPlot.m$rescale)) + geom_boxplot()
#+ scale_y_continuous(name = "Difference between old activity\nand new activity by step")+scale_x_discrete(name = "Mutation name")+theme_bw()  +theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(size = 11), legend.position = "bottom") +facet_grid(CyanosHeatPlot.m$rescale~.,scales="free")
View(CyanosHeatPlot.m)
View(CyanosTaxa)
View(CyanosTaxa)
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale)) + geom_boxplot()+theme_bw()+theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(angle = 90,size = 6), legend.position = "bottom")+facet_grid(CyanosTaxa$class~.,scales="free")
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale)) + geom_boxplot()+theme_bw()+theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(angle = 90,size = 6), legend.position = "bottom")
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale)) + geom_boxplot()+theme_bw()+theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(angle = 90,size = 6), legend.position = "bottom")
#+facet_grid(CyanosTaxa$class~.,scales="free")
#ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable,y=CyanosHeatPlot.m$rescale,fill=CyanosHeatPlot.m$rescale))
# +facet_grid(CyanosHeatPlot.m$rescale~.,scales="free")
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale)) + geom_boxplot()+theme_bw()+theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(angle = 90,size = 6), legend.position = "bottom")
```{r Heaplot_summary}
ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale)) + geom_boxplot()+theme_bw()+theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(angle = 90,size = 6), legend.position = "bottom")
expansion_plot<-ggplot(CyanosHeatPlot.m, aes(x=CyanosHeatPlot.m$variable, y=CyanosHeatPlot.m$rescale)) + geom_boxplot()+theme_bw()+theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"), text = element_text(size = 12, family = "Arial"), axis.title = element_text(face="bold"), axis.text.x=element_text(angle = 90,size = 6), legend.position = "bottom")
ggplot(gene, aes(x=Strain, y=Gen))+ geom_raster(aes(fill=Value)) +
theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
coord_equal()+ scale_fill_gradientn(colours = hm.palette(100),na.value = "gray")
library(ggplot2)
library( reshape )
library(plyr )
library(RColorBrewer)
proteins <- read.table("Proteinas.r.data", header=TRUE, sep=",")
gene <- read.table("Gen.data.r", header=TRUE, sep=",")
egene <- read.table("Gen.especial.r.data", header=TRUE, sep=",")
eprotein <- read.table("Proteinas.especiales.r.data", header=TRUE, sep=",")
hm.palette <- colorRampPalette(rev(brewer.pal(11, 'Spectral')), space='Lab')
ggplot(eprotein, aes(x=Strain, y=Protein))+ geom_raster(aes(fill=Value)) +
theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
ggplot(egene, aes(x=Strain, y=Gen))+ geom_raster(aes(fill=Value)) +
theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
ggplot(proteins, aes(x=Strain, y=Protein))+ geom_raster(aes(fill=Value)) +
theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
ggplot(eprotein, aes(x=Strain, y=Protein))+ geom_raster(aes(fill=Value)) +
theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
ggplot(eprotein, aes(x=Strain, y=Protein))+ geom_raster(aes(fill=Value)) + theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
eprotein <- read.table("Proteinas.especiales.r.data", header=TRUE, sep=",")
setwd("~/Escritorio/Colaboraciones/Cesar")
setwd("/home/nelly/Escritorio/Colaboraciones/cesar")
proteins <- read.table("Proteinas.r.data", header=TRUE, sep=",")
gene <- read.table("Gen.data.r", header=TRUE, sep=",")
egene <- read.table("Gen.especial.r.data", header=TRUE, sep=",")
eprotein <- read.table("Proteinas.especiales.r.data", header=TRUE, sep=",")
hm.palette <- colorRampPalette(rev(brewer.pal(11, 'Spectral')), space='Lab')
ggplot(eprotein, aes(x=Strain, y=Protein))+ geom_raster(aes(fill=Value)) + theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
ggplot(egene, aes(x=Strain, y=Gen))+ geom_raster(aes(fill=Value)) +
theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
ggplot(proteins, aes(x=Strain, y=Protein))+ geom_raster(aes(fill=Value)) +
theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
ggplot(gene, aes(x=Strain, y=Gen))+ geom_raster(aes(fill=Value)) +
theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
ggplot(gene, aes(x=Strain, y=Gen))+ geom_raster(aes(fill=Value)) +
theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
coord_equal()+ scale_fill_gradient(low = "white" , high = "steelblue",na.value = "orange")
ggplot(gene, aes(x=Strain, y=Gen))+ geom_raster(aes(fill=Value)) +
theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
coord_equal()+ scale_fill_gradientn(colours = hm.palette(100),na.value = "gray")
hm.palette <- colorRampPalette(rev(brewer.pal(11, 'Spectral')), space='Lab')
heatplot <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+ geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradientn(colours = hm.palette(100),na.value = "gray")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
library(RColorBrewer)
library(ggplot2)
library( reshape )
library(plyr )
library(RColorBrewer)
library(scales)
library(plyr)
library(RColorBrewer)
hm.palette <- colorRampPalette(rev(brewer.pal(11, 'Spectral')), space='Lab')
library(RColorBrewer)
library(ggplot2)
library( reshape )
library(plyr )
library(RColorBrewer)
library(scales)
library(plyr)
library(RColorBrewer)
hm.palette <- colorRampPalette(rev(brewer.pal(11, 'Spectral')), space='Lab')
heatplot <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+ geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradientn(colours = hm.palette(100),na.value = "gray")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
ggsave("chapter5/HeatPlot.pdf", plot = heatplot,height = 12, width = 6)
```{r boxplot_CyanoHP,warnings = FALSE, message = FALSE}
qplot(x=clarity, data=diamonds, geom="bar", fill=cut, position="stack")
View(diamonds)
qplot(x=clarity, data=diamonds, geom="bar", fill=cut, position="stack")
View(CyanosSMASH)
View(CyanosSMASH)
View(CyanosTaxa)
View(CyanosTaxa)
m1 <- merge(CyanosTaxa, CyanosSMASH, by.x = "CyanosTaxa$RastId", by.y = "CyanosSMASH$RastIds")
m1 <- merge(CyanosTaxa, CyanosSMASH, by.x = "RastId", by.y = "RastIds")
View(m1)
View(m1)
View(diamonds)
m1.m <- melt(m1, id = c("RastId", "Name"))
m1.m <- melt(m1, id = c("RastId", "Name","Phylum","Class","Order"))
m1.m <- melt(m1, id = c("RastId", "Name","Phylum","Class","Order","Family","Contigs","Size","RastNo"))
View(m1.m)
View(m1.m)
qplot(x=Family, data=m1.m, geom="bar", fill=variable, position="stack")
qplot(x=Order, data=m1.m, geom="bar", fill=Family, position="stack")
qplot(x=Order, data=m1.m, geom="bar", fill=Family, position="stack")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
qplot(x=Order, data=m1.m, geom="bar", fill=Family, position="stack")+theme_bw()+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
View(CyanosNp)
View(CyanosNp)
qplot(x=Central, data=CyanosNp, geom="bar", fill=kingdom, position="stack")+theme_bw()+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
```{r Phosphoribosyl_isomerase_evo_tree, results = "asis",message=FALSE}
View(CyanosNp)
View(CyanosNp)
qplot(x=Central, data=CyanosNp, geom="bar", fill=taxa, position="stack")+theme_bw()+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
CyanosNp <- read.table("chapter5/CyanosNp", header=TRUE, sep="\t")
qplot(x=Central, data=CyanosNp, geom="bar", fill=taxa, position="stack")+theme_bw()+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
library(ggplot2)
library( reshape )
library(plyr )
library(RColorBrewer)
library(scales)
library(plyr)
library(RColorBrewer)
hm.palette <- colorRampPalette(rev(brewer.pal(11, 'Spectral')), space='Lab')
qplot(x=Central, data=CyanosNp, geom="bar", fill=taxa, position="stack")+theme_bw()+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
qplot(x=Central, data=CyanosNp, geom="bar", fill=kingdom, position="stack")+theme_bw()+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
View(m1.m)
View(m1.m)
table(m1.m$Order>0,m1.m$Family>0)
qplot(x=Order, data=m1.m, geom="bar", fill=value, position="stack")+theme_bw()+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
m2.m<-m1(m1$value>0)
m2.m<-m1$value>0
m2.m
m2.m<-subset(m1.m,m1$value>0)
m2.m
View(m1.m)
View(m1.m)
View(CyanosTaxa)
View(CyanosTaxa)
View(CyanosSMASH)
View(CyanosSMASH)
View(m1)
View(m1)
View(m2.m)
View(m2.m)
m1 <- merge(CyanosTaxa, CyanosSMASH, by.x = "RastId", by.y = "RastIds")
m1.m <- melt(m1, id = c("RastId", "Name","Phylum","Class","Order","Family","Contigs","Size","RastNo"))
m2.m<-subset(m1.m,m1$value>0)
m2.m<-subset(m1.m,value>0)
qplot(x=Order, data=m1.m, geom="bar", fill=variable, position="stack")+theme_bw()+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
qplot(x=Order, data=m2.m, geom="bar", fill=variable, position="stack")+theme_bw()+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
qplot(x=Order, data=m2.m, geom="bar", fill=variable, position="stack")+theme_bw()+ theme(legend.position="none",text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
qplot(x=Order, data=m2.m, geom="bar", fill=variable, position="stack")+theme_bw()+ theme(colours = hm.palette(100),legend.position="none",text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
qplot(x=Order, data=m2.m, geom="bar", fill=variable, position="stack",colours = hm.palette(100))+theme_bw()+ theme(legend.position="none",text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
qplot(x=Order, data=m2.m, geom="bar", fill=variable, position="stack",colours = hm.palette(1000))+theme_bw()+ theme(legend.position="none",text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
qplot(x=Order, data=m2.m, geom="bar", fill=variable, position="stack",colours = hm.palette(10000))+theme_bw()+ theme(legend.position="none",text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
qplot(x=Order, data=m2.m, geom="bar", fill=variable, position="stack",colours = hm.palette(100000))+theme_bw()+ theme(legend.position="none",text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
View(CyanosHeatPlot.m)
View(CyanosHeatPlot.m)
View(CyanosHeatPlot)
View(CyanosHeatPlot)
HP_Taxa<-merge(CyanosHeatPlot,CyanosTaxa,RastId,RastId)
HP_Taxa<-merge(CyanosHeatPlot,CyanosTaxa,by.x = "RastId",by.y = "RastId")
View(HP_Taxa)
View(HP_Taxa)
HP_Taxa[order(HP_Taxa$Family),]
HP_Taxa<-HP_Taxa[order(HP_Taxa$Family),]
HP_Taxa<-HP_Taxa[order(HP_Taxa$Order,HP_Taxa$Family),]
HP_Taxa<- melt(HP_Taxa)
HP_Taxa<-merge(CyanosHeatPlot,CyanosTaxa,by.x = "RastId",by.y = "RastId")
HP_Taxa<-HP_Taxa[order(HP_Taxa$Order,HP_Taxa$Family),]
HP_Taxa.m<- melt(HP_Taxa)
HP_Taxa.m<- ddply(HP_Taxa, .(variable), transform,rescale=scale(value))  ## rescale escala toda la matriz, scale por columnas
HP_Taxa.m<- ddply(HP_Taxa.m, .(variable), transform,rescale=scale(value))  ## rescale escala toda la matriz, scale por columnas
heatplot <- ggplot(HP_Taxa.m, aes(HP_Taxa.m$variable, HP_Taxa.m$RastId))+ geom_tile(aes(fill = HP_Taxa.m$rescale), colour = "white") + scale_fill_gradientn(colours = hm.palette(100),na.value = "gray")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) )
ggsave("chapter5/HeatPlot.pdf", plot = heatplot,height = 12, width = 6)
View(HP_Taxa)
HP_Taxa<-subset(HP_taxa,HP_Taxa$Order=Chroococcales)
HP_Taxa<-subset(HP_taxa,HP_Taxa$Order="Chroococcales")
HP_Taxa2<-subset(HP_taxa,HP_Taxa$Order="Chroococcales")
HP_Taxa2<-subset(HP_taxa,Order="Chroococcales")
HP_Taxa<-merge(CyanosHeatPlot,CyanosTaxa,by.x = "RastId",by.y = "RastId")
HP_Taxa2<-subset(HP_taxa,Order="Chroococcales")
HP_Taxa2<-subset(HP_Taxa,Order="Chroococcales")
HP_Taxa<-subset(HP_Taxa,Order="Chroococcales")
HP_Taxa<-HP_Taxa[order(HP_Taxa$Order,HP_Taxa$Family),]
HP_Taxa.m<- melt(HP_Taxa)
HP_Taxa.m<- ddply(HP_Taxa.m, .(variable), transform,rescale=scale(value))  ## rescale escala toda la matriz, scale por columnas
View(HP_Taxa.m)
View(HP_Taxa.m)
HP_Taxa<-merge(CyanosHeatPlot,CyanosTaxa,by.x = "RastId",by.y = "RastId")
HP_Taxa<-subset(HP_Taxa,Order="Chroococcales")
View(HP_Taxa)
View(HP_Taxa)
HP_Taxa2<-subset(HP_Taxa,Order="Chroococcales")
View(HP_Taxa2)
View(HP_Taxa2)
HP_Taxa2<-subset(HP_Taxa,Order='Chroococcales')
View(CyanosSMASH)
View(CyanosSMASH)
View(CyanosHeatPlot)
View(CyanosHeatPlot)
EXP_SMASH<-merge(CyanosHeatPlot,CyanosSMASH,by.x="RastId",by.y="RastIds")
View(EXP_SMASH)
View(EXP_SMASH)
EXP_SMASH$TOTAL.x
EXP_SMASH$TOTAL.y
qplot(Total.x, Total.y, data = EXP_SMASH, colour=Order)+theme_bw()+facet_grid(EXP_SMASH$Order~.,scales="free")+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(Total.x, Total.y, data = EXP_SMASH, colour=Order)+theme_bw()+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
EXP_SMASH<-merge(CyanosHeatPlot,CyanosSMASH,CyanosTaxa, by.x="RastId",by.y="RastIds",by.z="RastId")
qplot(Total.x, Total.y, data = EXP_SMASH, colour=Order)+theme_bw()+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
View(CyanosTaxa)
View(CyanosTaxa)
EXP_SMASH<-merge(CyanosHeatPlot,CyanosSMASH,CyanosTaxa, by.x="RastId",by.y="RastIds",by.z="RastId")
EXP_SMASH<-merge(EXP_SMASH,CyanosTaxa,by.x="RastId",by.y="RastId")
View(CyanosTaxa)
View(CyanosTaxa)
EXP_SMASH2<-merge(EXP_SMASH,CyanosTaxa,by.x="RastId",by.y="RastId")
View(EXP_SMASH2)
View(EXP_SMASH2)
qplot(Total.x, Total.y, data = EXP_SMASH)+theme_bw()+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
EXP_SMASH<-merge(CyanosHeatPlot,CyanosSMASH,by.x="RastId",by.y="RastIds")
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH)+theme_bw()+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
EXP_SMASH2<-merge(CyanosTaxa, EXP_SMASH, by.x="RastId",by.y="RastId")
View(EXP_SMASH2)
View(EXP_SMASH2)
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2)+theme_bw()+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order,colours = hm.palette(100000))+theme_bw()+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Family,colours = hm.palette(100))+theme_bw()+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Family,colours = hm.palette(100))+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order,colours = hm.palette(100))+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
View(eprotein)
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order,colours = hm.palette(100))+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(legend.position	="bottom",plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order,colours = hm.palette(100))+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+ scale_fill_brewer(palette="Dark2")+
theme(legend.position	="bottom",plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+ scale_fill_brewer(palette=hm.palette(100))+
theme(legend.position	="bottom",plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Family)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(legend.position	="bottom", plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Family)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme( plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+ scale_fill_brewer(palette=hm.palette(100))+
theme(legend.position	="bottom",plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+ scale_fill_brewer(palette=hm.palette(100))+
theme(legend.position	="bottom",plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
hm.palette <- colorRampPalette(rev(brewer.pal(11, 'Spectral')), space='Lab')
CyanosCentral <- read.table("chapter5/CyanosCentral", header=TRUE, sep="\t")
CyanosHeatPlot <- read.table("chapter5/CyanosHeatPlot", header=TRUE, sep="\t")
hm.palette <- colorRampPalette(rev(brewer.pal(11, 'Spectral')), space='Lab')
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+ scale_fill_brewer(palette=hm.palette(100))+
theme(legend.position	="bottom",plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(legend.position	="bottom",plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(legend.position	="bottom",plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
sn<-qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(legend.position	="bottom",plot.title = element_text(size = 14, family = "Arial", face = "bold"),
text = element_text(size = 12, family = "Arial"),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
sn+scale_fill_brewer(palette=hm.palette(100))
sn+scale_color_manual(values=wes_palette(n=3, name="GrandBudapest"))
sn + scale_color_brewer(palette="Dark2")
sn + scale_color_brewer(palette="Dark2(100)")
sn+ scale_color_hue(l=40, c=35)
sn + scale_color_brewer(palette=hm.palette(100))
sn + scale_color_brewer(palette=hm.palette(100))
sn + scale_color_brewer(palette=hm.palette
sn + scale_color_brewer(palette=hm.palette)
sn + scale_color_brewer(palette=hm.palette(10))
sn+ scale_color_hue(l=40, c=35)
sn<-qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(legend.position	="bottom",plot.title = element_text(size = 14, face = "bold"),
text = element_text(size = 12),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
table(CyanosTaxa$Order)
sn<-qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(legend.position	="bottom",plot.title = element_text(size = 14, face = "bold"),
text = element_text(size = 12),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
sn<-qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(legend.position	="bottom",plot.title = element_text(size = 14, face = "bold"),
text = element_text(size = 12),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
EXP_SMASH<-merge(CyanosHeatPlot,CyanosSMASH,by.x="RastId",by.y="RastIds")
sn<-qplot(TOTAL.x, TOTAL.y, data = EXP_SMASH2,colour=Order)+theme_bw()+facet_grid(EXP_SMASH2$Order~.,scales="free")+
theme(legend.position	="bottom",plot.title = element_text(size = 14, face = "bold"),
text = element_text(size = 12),
axis.title = element_text(face="bold"),
axis.text.x=element_text(size = 12),
axis.text.y=element_text(size = 7))
SMASHvsExpansionsbyOrder
