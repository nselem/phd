advisor: 'Francisco Barona Gomez'
install.packages("preprocessCore")
mydata110 <- read.table("chap5_files/CyanosCentral", header=TRUE, sep="\t")
View(mydata110)
CyanosCentral <- read.table("chap5_files/CyanosCentral", header=TRUE, sep="\t")
CyanosHeatPlot <- read.table("chap5_files/CyanosHeatPlot", header=TRUE, sep="\t")
library(ggplot2)
#setwd("/home/nelly/GIT/phd/Thesis/tesis/chap5_files")
CyanosCentral <- read.table("chap5_files/CyanosCentral", header=TRUE, sep="\t")
CyanosHeatPlot <- read.table("chap5_files/CyanosHeatPlot", header=TRUE, sep="\t")
CyanosNp <- read.table("chap5_files/CyanosNp", header=TRUE, sep="\t")
CyanosSMASH <- read.table("CyanosSMASH/CyanosSMASH", header=TRUE, sep="\t")
library(ggplot2)
#setwd("/home/nelly/GIT/phd/Thesis/tesis/chap5_files")
CyanosCentral <- read.table("chap5_files/CyanosCentral", header=TRUE, sep="\t")
CyanosHeatPlot <- read.table("chap5_files/CyanosHeatPlot", header=TRUE, sep="\t")
CyanosNp <- read.table("chap5_files/CyanosNp", header=TRUE, sep="\t")
CyanosSMASH <- read.table("chap5_files/CyanosSMASH", header=TRUE, sep="\t")
CyanosTaxa <- read.table("chap5_files/CyanosTaxa", header=TRUE, sep="\t")
View(CyanosCentral)
View(CyanosHeatPlot)
View(CyanosHeatPlot)
View(CyanosNp)
View(CyanosNp)
View(CyanosSMASH)
View(CyanosSMASH)
View(CyanosTaxa)
View(CyanosTaxa)
View(mydata110)
View(mydata110)
library(ggplot2)
#setwd("/home/nelly/GIT/phd/Thesis/tesis/chap5_files")
CyanosCentral <- read.table("chap5_files/CyanosCentral", header=TRUE, sep="\t")
library(ggplot2)
#setwd("/home/nelly/GIT/phd/Thesis/tesis/chap5_files")
CyanosCentral <- read.table("chapter5/CyanosCentral", header=TRUE, sep="\t")
CyanosHeatPlot <- read.table("chapter5/CyanosHeatPlot", header=TRUE, sep="\t")
CyanosNp <- read.table("chapter5/CyanosNp", header=TRUE, sep="\t")
CyanosSMASH <- read.table("chapter5/CyanosSMASH", header=TRUE, sep="\t")
CyanosTaxa <- read.table("chapter5/CyanosTaxa", header=TRUE, sep="\t")
library(ggplot2)
#setwd("/home/nelly/GIT/phd/Thesis/tesis/chap5_files")
CyanosCentral <- read.table("chapter5/CyanosCentral", header=TRUE, sep="\t")
CyanosHeatPlot <- read.table("chapter5/CyanosHeatPlot", header=TRUE, sep="\t")
CyanosNp <- read.table("chapter5/CyanosNp", header=TRUE, sep="\t")
CyanosSMASH <- read.table("chapter5/CyanosSMASH", header=TRUE, sep="\t")
CyanosTaxa <- read.table("chapter5/CyanosTaxa", header=TRUE, sep="\t")
library(ggplot2)
#setwd("/home/nelly/GIT/phd/Thesis/tesis/chap5_files")
CyanosCentral <- read.table("chapter5/CyanosCentral", header=TRUE, sep="\t")
CyanosHeatPlot <- read.table("chapter5/CyanosHeatPlot", header=TRUE, sep="\t")
CyanosNp <- read.table("chapter5/CyanosNp", header=TRUE, sep="\t")
CyanosSMASH <- read.table("chapter5/CyanosSMASH", header=TRUE, sep="\t")
CyanosTaxa <- read.table("chapter5/CyanosTaxa", header=TRUE, sep="\t")
View(CyanosCentral)
View(CyanosCentral)
View(CyanosHeatPlot)
View(CyanosHeatPlot)
View(CyanosNp)
View(CyanosNp)
View(CyanosSMASH)
View(CyanosSMASH)
ActinoCentral <- read.table("chapter4/ActinoCentral", header=TRUE, sep="\t")
ActinoHeatPlot <- read.table("chapter4/ActinoHeatPlot", header=TRUE, sep="\t")
ActinoNp <- read.table("chapter4/ActinoNp", header=TRUE, sep="\t")
ActinosSmashResults <- read.table("chapter4/ActinosSmashResults", header=TRUE, sep="\t")
ActinoTaxa <- read.table("chapter4/ActinoTaxa", header=TRUE, sep="\t")
ArchaeasCentral <- read.table("chapter3/ArchaeasCentral", header=TRUE, sep="\t")
ArchaeasHeatPlot <- read.table("chapter3/ArchaeasHeatPlot", header=TRUE, sep="\t")
ArchaeasNp <- read.table("chapter3/ArchaeasNp", header=TRUE, sep="\t")
ArchaeasSMASH <- read.table("chapter3/ArchaeasSMASH", header=TRUE, sep="\t")
ArchaeasTaxa <- read.table("chapter3/ArchaeasTaxa", header=TRUE, sep="\t")
ActinoCentral <- read.table("chapter4/ActinoCentral", header=TRUE, sep="\t")
ActinoHeatPlot <- read.table("chapter4/ActinoHeatPlot", header=TRUE, sep="\t")
ActinoNp <- read.table("chapter4/ActinoNp", header=TRUE, sep="\t")
ActinosSmashResults <- read.table("chapter4/ActinosSmashResults", header=TRUE, sep="\t")
ActinoTaxa <- read.table("chapter4/ActinoTaxa", header=TRUE, sep="\t")
View(CyanosTaxa)
View(CyanosTaxa)
View(CyanosSMASH)
View(CyanosSMASH)
View(CyanosNp)
View(CyanosNp)
View(CyanosHeatPlot)
View(CyanosHeatPlot)
View(CyanosCentral)
View(CyanosCentral)
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(RastIds, TOTAL))
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastIds, TOTAL))
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastIds, CyanosHeatPlot$TOTAL))
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastIds, CyanosHeatPlot$TOTAL))
setwd("~/GIT/phd/Thesis/tesis")
library(ggplot2)
library( reshape )
library(plyr )
library(RColorBrewer)
library(scales)
library(plyr)
#setwd("/home/nelly/GIT/phd/Thesis/tesis/chap5_files")
CyanosCentral <- read.table("chapter5/CyanosCentral", header=TRUE, sep="\t")
CyanosHeatPlot <- read.table("chapter5/CyanosHeatPlot", header=TRUE, sep="\t")
CyanosNp <- read.table("chapter5/CyanosNp", header=TRUE, sep="\t")
CyanosSMASH <- read.table("chapter5/CyanosSMASH", header=TRUE, sep="\t")
CyanosTaxa <- read.table("chapter5/CyanosTaxa", header=TRUE, sep="\t")
nba <- read.csv("http://datasets.flowingdata.com/ppg2008.csv")
nba$Name <- with(nba, reorder(nba$Name, nba$PTS))
nba.m <- melt(nba)
nba.m <- ddply(nba.m, .(variable), transform, rescale=rescale(value))
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastId, CyanosHeatPlot$TOTAL))
CyanosHeatPlot.m <- melt(CyanosHeatPlot)
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform, rescale=rescale(value))
(p <- ggplot(CyanosHeatPlot.m, aes(variable, CyanosHeatPlot)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
#(p <- ggplot(nba.m, aes(variable, Name)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
library(ggplot2)
library( reshape )
library(plyr )
library(RColorBrewer)
library(scales)
library(plyr)
#setwd("/home/nelly/GIT/phd/Thesis/tesis/chap5_files")
CyanosCentral <- read.table("chapter5/CyanosCentral", header=TRUE, sep="\t")
CyanosHeatPlot <- read.table("chapter5/CyanosHeatPlot", header=TRUE, sep="\t")
CyanosNp <- read.table("chapter5/CyanosNp", header=TRUE, sep="\t")
CyanosSMASH <- read.table("chapter5/CyanosSMASH", header=TRUE, sep="\t")
CyanosTaxa <- read.table("chapter5/CyanosTaxa", header=TRUE, sep="\t")
nba <- read.csv("http://datasets.flowingdata.com/ppg2008.csv")
nba$Name <- with(nba, reorder(nba$Name, nba$PTS))
nba.m <- melt(nba)
nba <- read.csv("http://datasets.flowingdata.com/ppg2008.csv")
nba$Name <- with(nba, reorder(nba$Name, nba$PTS))
nba.m <- melt(nba)
nba <- read.csv("http://datasets.flowingdata.com/ppg2008.csv")
nba$Name <- with(nba, reorder(nba$Name, nba$PTS))
nba.m <- melt(nba)
View(nba.m)
View(nba.m)
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastId, CyanosHeatPlot$TOTAL))
CyanosHeatPlot <- read.table("chapter5/CyanosHeatPlot", header=TRUE, sep="\t")
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastId, CyanosHeatPlot$TOTAL))
CyanosHeatPlot.m <- melt(CyanosHeatPlot)
View(CyanosHeatPlot.m)
View(CyanosHeatPlot.m)
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform, rescale=rescale(value))
(p <- ggplot(CyanosHeatPlot.m, aes(variable, CyanosHeatPlot)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
#(p <- ggplot(nba.m, aes(variable, Name)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform, rescale=rescale(value))
(p <- ggplot(CyanosHeatPlot.m, aes(variable, CyanosHeatPlot$RastId)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastId, CyanosHeatPlot$TOTAL))
CyanosHeatPlot.m <- melt(CyanosHeatPlot)
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform, CyanosHeatPlot$rescale=rescale(value))
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform,rescale=rescale(value))
rescale
CyanosHeatPlot$rescale
CyanosHeatPlot.m.$rescale
CyanosHeatPlot.m$rescale
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +coord_equal()+scale_fill_gradient(low = "white", high = "black",na.value = "orange")
```
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "black",na.value = "orange") + theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "black",na.value = "orange") + theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
#+coord_equal()
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "black",na.value = "orange")
#+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "black",na.value = "orange"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") +scale_fill_gradient(low = "white", high = "black"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue"))
RastId
CyanosHeatPlot$RastId <- with(CyanosHeatPlot, reorder(CyanosHeatPlot$RastId, CyanosHeatPlot$TOTAL))
CyanosHeatPlot.m <- melt(CyanosHeatPlot)
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform,rescale=rescale(value))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "black"))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)))
CyanosHeatPlot.m <- melt(CyanosHeatPlot)
CyanosHeatPlot.m<- ddply(CyanosHeatPlot.m, .(variable), transform,rescale=scale(value))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)))
#(p <- ggplot(nba.m, aes(variable, Name)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 330, hjust = 1, vjust = 0.5)+axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5)))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)+axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5)))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)  ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 330, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5) ))
#(p <- ggplot(nba.m, aes(variable, Name)) + geom_tile(aes(fill = rescale), colour = "white") +scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 330, hjust = 0, vjust = 0.5)+axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5)))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 330, hjust = 0, vjust = 0.5) ,axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5) ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 0, vjust = 0.5) ,axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5) ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 330, hjust = 1, vjust = 0.5) ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) ))
CyanosHP.s <- ddply(CyanosHeatPlot.m, .(variable), transform, rescale = scale(value))
View(CyanosHP.s)
last_plot() %+% CyanosHP.s
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+geom_text() + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+geom_text(aes(fill = CyanosHeatPlot.m$rescale)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) ))
(p <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+geom_text(aes(label=CyanosHeatPlot.m$rescale)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) ))
label = "CyanoPlot", type = "figure")
(heatplot <- ggplot(CyanosHeatPlot.m, aes(CyanosHeatPlot.m$variable, CyanosHeatPlot.m$RastId))+geom_text(aes(label=CyanosHeatPlot.m$rescale)) + geom_tile(aes(fill = CyanosHeatPlot.m$rescale), colour = "white") + scale_fill_gradient(low = "white", high = "steelblue")+ theme(text = element_text(size=8), axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5) ,axis.text.y = element_text(angle = 0, hjust = 1, vjust = 0.5) ))
ggsave("chapter5/HeatPlot.pdf", plot = heatplot,
height = 3, width = 6)
label(path = "chapter5/HeatPlot.pdf", caption = "Cyanobacterial Heatplot",  label = "CyanoPlot", type = "figure")
