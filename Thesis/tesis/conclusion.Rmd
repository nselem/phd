---
output: pdf_document
---

# Metodologia {.unnumbered}
  \setcounter{chapter}{4}
	\setcounter{section}{0}

                          
## Protocolos para usar Orthocore, myRAST, fastOrtho, Clavigenomics, y BPGA  
Anotación genómica con el docker myRAST  

Esta es una distribución de myRAST en un contenedor de docker. Para usarla se necesita una cuenta del anotador genómico RAST. el docker myRAST permite hacer anotación genómica y funcional masiva mediante el uso de la terminal en el anotador RAST. Después de anotar los resultados pueden descargarse y procesarse en una terminal  

Descargar myrast docker distribution   

Una vez con docker instalado en la computadora, se hace pull al docker myrast.  

docker pull nselem/myrast  
Abrir myRast en la terminal  

docker run -i -t -v $(pwd):/home nselem/myrast /bin/bash  

Usar myRast  

-Ejemplo subir un archivo fasta  

svr_submit_RAST_job -user <user> -passwd <pass> -fasta <file> -domain Bacteria -bioname "Organism name" -genetic_code 11 -gene_caller rast  

-Para bajar un archivo de anotación genómica funcional:  

svr_retrieve_RAST_job <user> <password> <jobId> table_txt > $ID.txt  

Una lista completa de archivos puede ser procesada usando bash. Por ejemplo para bajar una lista de archivos de RAST se deben guardar los identificadores de RAST en una columna de un archivo, (Rast_ID en este ejemplo) y usar un while para obtenerlos:  

En este caso la variable “line” contendrá el identificador RAST Id, y cada archivo fasta de aminácidos podrá ser obtenido mediante su identificador de RASTy será guardado en el archivo “$line.faa”  

cut -f1 Rast_ID | while read line; do svr_retrieve_RAST_job <user> <password> $line amino_acid > $line.faa ; done  
Formatos de RAST para descargar archivos   

Puedes cambiar el formato table_txt por el que tú necesites.  

Table: Formatos de descarga disponibles en myRAST \label{tab:myrast}
  
|Atributo        |Descripción                                             |  
|----------------|--------------------------------------------------------|  
|genbank         |GenBank (con funciones y enriquecimiento de SEED)       |  
|genbank_stripped|Genbank con EC-numbers removidos de las funciones|  
|embl            |EMBL (con funciones y enriquecimiento de SEED)  |  
|embl_stripped   |EMBL con EC-numbers removidos de las funciones|  
|gff3            |GFF3|  
|gff3_stripped |GFF3 con EC-numbers removidos de las funciones|  
|gtf |GTF|  
|gtf_stripped|  GTF con EC-numbers removidos de las funciones|  
|rast_tarball | Archivo comprimido (gzipped) con todo el directorio de las anotaciones de RAST sobre el genoma|  
|nucleic_acid|  Fasta de DNA de genes|  
|amino_acid  |Fasta de DNA de aminoácidos|  
|table_txt|Gene data in tab-separated format|   
|table_xls|Preserve the original gene calls and use RAST|  

  Referencia `r ref("myrast", type = "table")`.  
  
## Orthocore  

El umbral de e-value de Orthocore es por default 1e-6. Todas las secuencias son alineadas usando MUSCLE v3.8.31 con los parámetros default y curadas utilizando Gblocks con 5 posiciones como longitud mínima del  bloque, 10 como máximo número de posiciones contiguas no conservadas y sólo considerando posiciones con gaps menores que el 50% de las secuencias en el alineamiento final. Después de esta curación las secuencias son concatenadas en una matriz final.




# Conclusión 
	\setcounter{section}{1}
Idea de Rosario
-ver dell cluster de saxitoxin cuantos pasos se necesitron para llegar ahi.  
-A donde se iria el resultado de abrir el GMP  
-Otra vez, que Actinos tienen FolE  

## Discusion 
Finalmente, una pregunta abierta es aún dada una enzima promiscua es la población promiscua, y son sólo unos confórmeros o todas y cada una de las enzimas son promiscuas 


If we don't want Conclusion to have a chapter number next to it, we can add the `{.unnumbered}` attribute.  This has an unintended consequence of the sections being labeled as 3.6 for example though instead of 4.1.  The \LaTeX\ commands immediately following the Conclusion declaration get things back on track.

#### More info

And here's some other random info: the first paragraph after a chapter title or section head _shouldn't be_ indented, because indents are to tell the reader that you're starting a new paragraph. Since that's obvious after a chapter or section title, proper typesetting doesn't add an indent there.

<!--
If you feel it necessary to include an appendix, it goes here.
-->

\appendix

# The First Appendix

This first appendix includes all of the R chunks of code that were hidden throughout the document (using the `include = FALSE` chunk tag) to help with readibility and/or setup.

#### In the main Rmd file:

```{r ref.label = 'include_packages', results = 'hide', echo = TRUE}
```

#### In [](#ref_labels):

```{r ref.label = 'include_packages_2', results = 'hide', echo = TRUE}
```

# The Second Appendix, Open source code on this document
## R markdown  
Thanks to Rmakdown  Thesis  
Apendix one Useful docker commands   
-Create a new repository  
`docker build . -t evomining`  
`docker push nselemevomining`

## Docker  
Restart docker and free all ports  
`sudo service docker restart`   

list containers  
`docker ps -a`  

ssh or bash into a running docker container  
`sudo docker exec -i -t romantic_brahmagupta /bin/bash`
`docker exec -it <mycontainer> bash`  


Stop all containers  
`docker rm $(docker ps -a -q)`  

Remove stopped containers   
`docker rm $(docker ps -q -f status=exited)`

Remove all images  
`docker rmi $(docker images -q)`  

uninstall docker from ubuntu (Fresh start)   
`sudo apt-get purge docker-engine`   
`sudo apt-get autoremove --purge docker-engine`    
`rm -rf /var/lib/docker`   # This deletes all images, containers, and volumes

Run Evomining container using nselem/newevomining image  
` docker run -i -t -v /home/nelly/GIT/EvoMining/:/var/www/html/EvoMining/exchange -p 80:80 nselem/newevomining /bin/bash`
  
Start evomining inside this container   
`perl startevomining`  

Vizualice a tree  
`http://10.10.100.234/EvoMining/cgi-bin/color_tree.pl?9&&/var/www/html/EvoMining/exchange/CyanosBBH_MiBIG_DB.faa_CYANOS`
file 9.new must be on folder volume CyanosBBH_MiBIG_DB.faa_CYANOS  

Find a perl module  
`perl -MList::Util -e'print $_ . " => " . $INC{$_} . "\n" for keys %INC'`
EvoMining notes  
Gblocks only runs inside folder /var/www/html/EvoMining  

## Git  
`git add --all`  
`git commit -m "Some message"`   
`git push -u origin master`   
`git clone `  

## Connect GitHub and DockerHub
automated builds
The Dockerfile is available to anyone with access to your Docker Hub repository.
Your repository is kept up-to-date with code changes automatically.

## Additional resources

- _Markdown_ Cheatsheet - <https://github.com/adam-p/markdown-here/wiki/Markdown-Cheatsheet>

- _R Markdown_ Reference Guide - <https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf>

- Introduction to `dplyr` - <https://cran.rstudio.com/web/packages/dplyr/vignettes/introduction.html>

- `ggplot2` Documentation - <http://docs.ggplot2.org/current/>

Docker antiSMASH  run_antismash /<some>.gbk ~/as_results --knownclusterblast --inclusive --cf_threshold 0.7  

# El tercer Apéndice, Protocolos experimentales utilizados en el estudio de PriA  
```{r materials, child = 'chapter4/materiales.Rmd'}
```

```{r ProteinPurification, child = 'chapter4/ProteinPurification.Rmd'}
```

```{r ProteinQuantification, child = 'chapter4/ProteinQuantification.Rmd'}
```

