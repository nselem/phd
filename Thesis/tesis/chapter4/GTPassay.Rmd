---
title: "GTPassay"
author: "NellySelem"
date: "May 18, 2017"
output: pdf_document
---
```{r include_reedtemplates_GTP, include = FALSE}
# This chunk ensures that the reedtemplates package is installed and loaded
# This reedtemplates package includes the template files for the thesis and also
# two functions used for labeling and referencing
if(!require(devtools))
  install.packages("devtools", repos = "http://cran.rstudio.com")

if(!require(reedtemplates)){
  library(devtools)
  devtools::install_github("ismayc/reedtemplates")
  }
library(reedtemplates)
```

```{r load_pkgs_GTP, message = FALSE,echo=FALSE}
# List of packages required for this analysis
pkg <- c("dplyr", "ggplot2", "knitr", "devtools","RColorBrewer")
# Check if packages are not installed and assign the
# names of the packages not installed to the variable new.pkg
new.pkg <- pkg[!(pkg %in% installed.packages())]
# If there are any packages in the list that aren't installed,
# install them
if (length(new.pkg))
  install.packages(new.pkg, repos = "http://cran.rstudio.com")
# Load packages
library(dplyr)
library(plyr)
library(reshape) ## melt
library(ggplot2)
library(knitr)
library(RColorBrewer)
hm.palette <- colorRampPalette(rev(brewer.pal(11, 'Spectral')), space='Lab')  
#library(genstats) ## Next libraries are for coursera
library(devtools)
library(Biobase)
library(scales) # 
library(xlsx) # For save data on excel
library(knitr)
#library(drc) # for fitting Michaelis Menten model
library(ggplot2) # for drawing

```

## GTP enzymatic assay  
  
Based on docking GTP affinity a preliminary enzymatic assay was performed.  
  Sugerencia de lia... buscar niveles intracelulares de GTP (Bionumbers DB)  
  Intracellular GTP concentration in glucose-fed, exponentially growing E. coli 	Bacteria Escherichia coli 	4.9 	mM 	104697 	
  Aumentar al orden de mM  
Bennett BD, Kimball EH... 

Poner como control Gtp en buffer sin enzima  
EDTA, 0.1mM DTT probar quitar estos componentes  

### Preliminar dGTP assay conditions:  
  
$1\mu M$ dGTP (Invitrogen)  
TrpF Buffer (50mM Tris-HCL buffer pH8.0, 5% glycerol, 0.5 mM EDTA, 0.1mM DTT)  
50nM PriA vs 50 nM PriA D11A  

Method: Fluorimetry (black box)
Excitation wavelength: 255 nm
Emission wavelength: 334 nm

```{r mutControl, results = "asis",message=FALSE,echo=FALSE}
label(path = "MutantControl.png", caption = "Scoe and non functional Scoe PriA acting on dGTP",scale=.6,label = "PriARutas", type = "figure")
```


### Preliminar assays to test enzyme activity   (Ernesto)
To test preliminary results we perform the following activity test assays.  
  
We will use $160 \mu l$ as final reaction volume.     
<$150 \mu l$ Buffer  
$5\mu l$ substrate at $50 \mu M$  (Stock at $1.6 mM$)  
$5 \mu l$ enzyme at $2.5 \mu M$  (Stock at $80 \mu M$)  
    
   ***
     
Now I will calculate substrate stock concentration needed to obtain a final concentration of $50 \mu M$ on a final volume of $160 \mu l$ adding $5 \mu l$ of substrate.  
$C_1=\frac{50\mu M \times 160\mu l}{5 \mu l}=1600\mu M = 1.6mM$      
So we need to prepare an stock of $1.6mM$ of substrate concentration. Commercial stock is at $100mM$ , so on a first dilution 1:10 named $C_0$, (90$H_20$ $\mu l$ and 10 $mu l$ GTP) we obtain our lab stock at $10mM$.
  
***
  
To obtain $1.6 mM$ again the formula $C_1 V_1=C_2 V_2$ was used. $100\mu l$ were prepared thinking on 10 reactions of $5 \mu l$ each one.  
$V_1=\frac{1.6mM\times 100\mu l}{10mM}=16\mu l$  
so $16 \mu l$ substrate was diluted on 84 $\mu l$ of $H_2O$.
    
  ***
    
Next I will explain calculus of enzyme stock concentration needed in order to obtain a final concentration of $2.5 \mu l$ on a final volume of $160 \mu l$ adding $5 \mu l$ of enzyme.  
$C_1=\frac{2.5\mu M \times 160\mu l}{5 \mu l}=80\mu M$    
So we need to prepare an stock of $80\mu M$ of enzyme concentration. An example was calculated using again the formula $C_1 V_1=C_2 V_2$.     
    
  *** 
Example  
We will prepare $20 \mu l$ of stock because we need $15 \mu l$ for three reactions. A little excess must ALWAYS be prepared for pipeting needs.  
_Streptomyces sp Mg1_ enzyme concentration obtained was $461 \mu M$, so to obtain $20 \mu l$ we must add:  $V_1=\frac{80\times 20}{461}\mu l= 3.4 \mu l$    
$3.4 \mu l$ of enzyme to $16.6\mu l$ TrpF reaction buffer.  
Generalizing:  
$C_1=x\mu M$, $V_1=y$, $C_2=80\mu M$, $V_2=20\mu l$  
  
  ***  
     
$$
\centering
\label{enzyme_volume_gtp}
\begin{tabular}{ l l c c c}
\hline \\ [-1.5ex]
Enzyme  & from Organism & Concentration   & Enzyme $\mu l$ & Buffer $\mu l$\\ [1ex]
\hline \\ [-1.5ex]
\hline
PriB & SMg1   & $461\mu M$  & 3.4 & 16.6\\  [1ex]
PriB & Ssvi   & $100\mu M$  & 16  & 4  \\  [1ex]
PriB & JDen   & $215\mu M$  & 7.4 & 12.6 \\  [1ex]
PriA & Tcur   & $335\mu M$  & 4.7 & 15.3\\  [1ex]
PriA & Sros   & $450\mu M$  & 3.5 & 16.5\\  [1ex]
PriA & Smeg   & $370\mu M$  & 4.3 &15.7 \\  [1ex]
PriB & Sspc   & $1346\mu M$ & 1.1 &18.9  \\  [1ex]
\hline
\end{tabular}
$$

### Results 
```{r activity, message = FALSE,echo=FALSE,warning=FALSE}
GTP <- read.table("GTP.activity", header=TRUE, sep="\t")
dGTP <- read.table("dGTP.activity", header=TRUE, sep="\t")
GTP.m <- melt(GTP,id="Time")

plot(GTP.m$Time, GTP.m$value, col=GTP.m$variable, pch=19)

plot.new()
legend("bottom", legend = unique(GTP.m$variable), col = unique(GTP.m$variable), pch=19)

```

the two enzymes with major activity were:   
_Thermomonospora curvata_ thermophilic Actinobacteria from Thermomonosporaceae genus, it can be found in compost and participate in the active degradation of cellulose [@chertkov_complete_2011]. 
Jonesia trpF shows no activity

_Jonesia denitrificans_ is classified as a pathogenic organism for animals, reported genome was originally isolated from cooked ox blood [@pukall_complete_2009].  

```{r activity_splited, message = FALSE,echo=FALSE,warning=FALSE}

ggplot(GTP.m, aes(x=Time, y=value,color=variable)) + geom_point()+ facet_wrap(~ variable)+ geom_smooth()+theme_bw()+theme(plot.title = element_text(size = 8, face = "bold"), text = element_text(size = 12), axis.title = element_text(face="bold"), axis.text.y=element_text(angle = 30,size = 1), legend.position = "bottom")+ scale_size_area()
```

\clearpage   

 
### Karina second attempt to obtain enzyme kinetics.  
Now we will try substrate at different concentrations.  

GTP is commercially available at stocks of $100mM$
We want 8 different concentrations between 0 and 50mM on a final volume of $160\mu l$. We chose 0,0.5,1,1.5,5,10,20,50 as the eight points.  

Dilutions were made to reach this concentrations.
$C_{stock}= 100mM$ dil0  Stock original
$C_0= 10mM=10000\mu M$ dil1 1:10 primera dilucsio la llame dil0 Stock de nelly
$C_1= 1000\mu M$ dil2 1:10
$C_2= 100\mu M$ dil3  1:10
$C_3= 10\mu M$ dil4 1:10
$C_4= 1\mu M$ dil5 1:10

$[S] =[dGTP]=10000\mu M$  
$[E]=50nM$  

$$
\label{Sco_jueves}
\begin{tabular}{c c c c}
\hline \\ [-1.5ex]
Concentration $(\mu M)$  & Buffer $(\mu l)$ & Enzyme $(\mu l)$   & dGTP $(\mu l)$\\ [1ex]
\hline \\ [-1.5ex]
\hline
   0  & 156.1  & 3.9 & 0 dil4   \\  [1ex]
   0.5& 148.1  & 3.9 & 8 dil4\\  [1ex]
   1  &  140.1   & 3.9 & 16 dil4\\  [1ex]
   1.5&  132.1 & 3.9 & 24 dil4\\  [1ex]
   5  &76.1  & 3.9 & 80 dil4  \\  [1ex]
  10  & 140.1  & 3.9 & 16 dil3\\  [1ex]
  20  & 124.1  & 3.9 & 32 dil3\\  [1ex]
  50  & 76.1  & 3.9 & 80 dil3\\  [1ex]
\hline
\end{tabular}
$$

## Calculate your own GTP data
```{r GTP_Stocks}
#PriA_stock=48.5 ##uM D11A
PriA_stock=40 ##uM Scoe
type="Scoe"
hole_vol=170 ##ul
PriA_final=1 ##uM final concentration on hole
#PriA_final=.050 ##uM = 50 nM final concentration on hole
PriA_vol=hole_vol*PriA_final/PriA_stock
PlateColum=2
## 
GTP_stock=100000000 ##100,000,000nM-> 100,000uM-> 100mM
```


```{r GTP_tables}

GTPdata <- read.table(header=TRUE, text='
  GTP_Dilution  
  3       
  3   
  3   
  4  
  4  
  4 
  4 
  5  
')


PriA<-rep(PriA_vol,8)  ## 

##Use following line when mM concentrations are needed
#GTP_mM<-rev(c(0,0,.5,1,2.5,5,10,15))  # en 150  eliminamos la enzima columna
#GTPdata["GTP_uM"]<-GTP_mM*1000

##Use following line when uM concentrations are needed, please comment when no needed
GTP_uM<-rev(c(0, .5,1,2,5, 10,25,50)) 
GTPdata["GTP_uM"]<-GTP_uM

#GTP_uM<-rev(c(0,0,.0005,.0001,2.5,5,10,15))  # en 150  eliminamos la enzima columna

#GTPdata["GTP_uM"]<-GTP_uM

#Calculating volumes accordi
GTPdata["Vol"] <-1000*hole_vol*GTPdata["GTP_uM"]/(GTP_stock*10**(-1*GTPdata["GTP_Dilution"])) # That creates the new column named "MY_NEW_COLUMN" 

GTPdata["PriA_ul"]<-round(PriA_vol,digits=2)

# As an example, the new column receives
GTPdata$Buffer <- round(160-GTPdata$Vol-GTPdata$PriA_ul,digits=2)

kable(GTPdata)
```

GTP Stock  100 $mM$ PriA final `r PriA_final` $\mu M$ 
\clearpage  
  
  
