---
title: "PRAassay"
author: "NellySelem"
date: "May 18, 2017"
output: pdf_document
---

```{r include_reedtemplates_PRA, include = FALSE}
# This chunk ensures that the reedtemplates package is installed and loaded
# This reedtemplates package includes the template files for the thesis and also
# two functions used for labeling and referencing
if(!require(devtools))
  install.packages("devtools", repos = "http://cran.rstudio.com")

if(!require(reedtemplates)){
  library(devtools)
  devtools::install_github("ismayc/reedtemplates")
  }
library(reedtemplates)
```

```{r load_pkgs_PRA, message = FALSE,echo=FALSE}
# List of packages required for this analysis
pkg <- c("dplyr", "ggplot2", "knitr", "devtools","RColorBrewer")
# Check if packages are not installed and assign the
# names of the packages not installed to the variable new.pkg
new.pkg <- pkg[!(pkg %in% installed.packages())]
# If there are any packages in the list that aren't installed,
# install them
if (length(new.pkg))
  install.packages(new.pkg, repos = "http://cran.rstudio.com")
# Load packages
library(dplyr)
library(plyr)
library(reshape) ## melt
library(ggplot2)
library(knitr)
library(RColorBrewer)
hm.palette <- colorRampPalette(rev(brewer.pal(11, 'Spectral')), space='Lab')  
library(genstats) ## Next libraries are for coursera
library(devtools)
library(Biobase)
library(scales) # 
library(xlsx) # For save data on excel
library(knitr)
library(drc) # for fitting Michaelis Menten model
library(ggplot2) # for drawing

```

```{r stock,echo=FALSE}
TrpC_stock=60 ##uM
TrpD_stock=40 ##uM
TrpF_stock=40 ##uM
type="Scoe"  #organism from 
AA_Stock=33 ##mM
hole_vol=170 ##ul
TrpF_final=2.4 ##uM final concentration on hole
TrpF_vol=hole_vol*TrpF_final/TrpF_stock  
```

## PRA enzymatic assay

## TrpF activity  
Important notes  
-Pre-reaction buffer solution does not contain Anthranilic acid (AA) or PRPP, neither does contain DTT, this reactives are prepared separately an added at the moment of the essay.  
   
-Maximum AA concentration that can be used to obtain confident data initial velocities without noise is 150mM  
  
- It is important, before realizing enzyme kinetics, to determine suitable concentration of the enzyme in process of characterization,  to avoid "initial velocities lost" or substrate hydrolysis 
  
- Kinetics were done on 96 plates especial to measure fluorescence, but from 8 to 8 reactions, i. e. every time 8 substrate concentrations using a multichanel pipette.   This are black plates.  
  
The enzymatic reaction to form PRA was realized using yTrpD at 25Â° starting with the addition of this enzyme at $1\mu M$ and tmTrpC at 1$\mu M$. Measures were made on a fluorimeter (TECAN) using excitation wavelength of 310 and emission wave length 400 nm  for anthranilic acid. Before starting measures, the equipment needs to calculate a series of parameters different for each measure, this conduces to lost time on the starting reaction, but for the PRA synthesis this is not important,  

When yTrpD is added a decreasing is observed on the fluorescence signal, this effect is due to the enzyme excess. Once the fluorescence signal is constant (i.e once all AA has been converted to PRA) the equipment is paused and kept on the same program, so when resuming time won't be lost by parameters adjustments mentioned before.  The next reaction is started with the addtion of TrpF activity enzyme, the enzymatic catalysis is monitored by 10 min following de fluorescence diminishing now due to the PRA dissaperaing (exitation wave length 310 nm emission wavelength 400 nm)   

### Obtaining of catalytic parameters to the TrpF activity  
Once the temporal progress of the TrpF enzyme reaction is obtained (enzymatic kinetics), initial velocities can be determined, with the linear part of the curve were PRA uptake is observed.

Catalytic parameters were obtained by non linear interpolation to the Michaelis-Menten equation using the program Micro Cal Origin version 5.0 considering to the adjustment the standard deviation of the triplicate essays. To this adjustment initial velocities vs concentrations of substrate PRA were graphed.  


_Reactives_  
  
>-TrpF  

>-TrpC `r TrpC_stock` $\mu M$  Stock  

>-TrpD `r TrpD_stock` $\mu M$  Stock   

>-Anthranilic acid(AA) (stored at -20C)  

>-Reaction Buffer TrpF    

>Fluorescence box (black box) 

>Excitation 310 emission 400 nm Anthranilic acid TECAN


_AA dilution_  
AA dilution at `r AA_Stock` $\mu M$ from a `r AA_Stock`mM stock.    
Dilutions were made to reach this concentrations.  
$D_{stock}=$ `r AA_Stock` $mM$ dil0    
$AA_1=$ `r AA_Stock/10`mM=`r AA_Stock*100`$\mu M$ dil1 1:10  
$AA_2=$ `r AA_Stock/100`mM dil2 1:10  
$AA_3=$ `r AA_Stock`$\mu M$ dil3  1:10  
Reactions are on holes of `r hole_vol` $\mu l$  

  ***
  
-Example:  Calculate volume for $5\mu M$ on `r hole_vol` $\mu l$ from Dil3(`r AA_Stock`$\mu M$)  
$x\mu l= \frac{5\mu M \times `r hole_vol` \mu l}{`r AA_Stock`\mu M}$  
$x=\frac{5\times `r hole_vol`}{`r AA_Stock`}=$ `r 5*hole_vol/AA_Stock` $\mu l$  

***

-Example:  Calculate volume for enzymes: $1\mu M$ TrpC enzyme on $`r hole_vol` \mu l$ from stock $`r TrpC_stock` \mu M$ 
$x\mu l `r TrpC_stock`\mu M= 1\mu M \times `r hole_vol` \mu l$  

> $x=$  `r  hole_vol*1/TrpC_stock` $\mu l$  


Following table is an example with `r type` PriA at `r TrpF_stock` $\mu M$ when $`r  TrpF_vol` \mu l$ leads fo a final concentration of $`r TrpF_final` \mu M$ on $`r hole_vol` \mu l$    
Volumes on table are on $\mu l$  

```{r PRA_essay_DATA, echo=FALSE}
TrpC<-rep(2.6,8)
TrpD<-rep(4,8)  ## 
AA_microMolar<-rev(c(1.25, 2.5,3.75,6.25,10, 20, 37.5,62.5))
AAdata <- read.table(header=TRUE, text='
  AA_Dilution  
  1           
  2    
  2   
  2   
  2   
  3 
  3  
  3  
')
AAdata["AA_uM"]<-AA_microMolar
#stock_con=33uM
stock_con<-AA_Stock*1000

#Calculating volumes accordi
AAdata["Vol"] <-round(hole_vol*AAdata["AA_uM"]/(stock_con*10**(-1*AAdata["AA_Dilution"])),digits = 2) # That creates the new column named "MY_NEW_COLUMN" 

#TrpF Concentration (ul needed to lead final concentration to 2.4uM) (TrpF_vol)
#TrpF volume  
#AAdata["TrpF "] <- round(TrpF_vol,digits=2) # That creates the new column named "MY_NEW_COLUMN" filled with "NA"
AAdata["TrpF"]<-2 ## muy activa en este caso recordad concentracion distinta a la hora de michaelis
AAdata["TrpC"]<-TrpC
AAdata["TrpD"]<-TrpD

AAdata["Buffer"] <- NA # That creates the new column named "MY_NEW_COLUMN" filled with "NA"

# As an example, the new column receives
AAdata$Buffer <- hole_vol-AAdata$Vol-AAdata$TrpC-AAdata$TrpD-AAdata$TrpF  

kable(AAdata)
```

With TrpC Stock `r TrpC_stock` $\mu M$ TrpD Stock `r TrpD_stock` $\mu M$ TrpF Stock `r TrpF_stock` $\mu M$ 



